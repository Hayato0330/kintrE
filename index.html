<!DOCTYPE html> 
<html lang="ja"> 
  <head>
     <meta charset="UTF-8">
      <title>口座画面</title>
       <link rel="stylesheet" href="css/index.css">
       </head> 

       

      <body> 
        <div class="phone"> 
          <div class="screen"> 
            <div class="profile">
            <img id="user_icon" src="https://via.placeholder.com/60" alt="アイコン">
             <p class="name" id="user-name">---</p>
             </div>
              <p class="account">
              口座番号：<span id="account-number">0000000</span>
              </p>
               
               
               <!-- 残高-->
                 <div class="row">
                   <div class="label" >残高</div> 
                   <div class="value"><span id="limit">0</span> 円</div> 
                  </div> 
                  <hr style="border:none;border-top:1px solid #eee;margin:12px 0;"> 
                  
                  
                  
               <!-- 送金「」円 --> 
                <div class="row" style="align-items:flex-end;"> 
                  <div> 
                    <div class="label">送金</div> 
                    <button class="primary" id="sendBtn">送金</button> 
                    <div id="msg" class="">

                    </div>
                   </div> 

                   <script>
                    document.getElementById("sendBtn").addEventListener("click", () => {
                      location.href = "pages/human_select.html"; });
                   </script>

                <!--請求-->
                 <div class="row" style="align-items:flex-end;">
                   <div>
                     <div class="label">請求</div>
                      <button class="primary" id="requestBtn">請求</button>
                       <div id="msg" class=""></div>
                    </div>
                  </div> 

  <script>
    document.getElementById("requestBtn").addEventListener("click", () => {
      location.href = "pages/7-1.html";
    });
  </script>
        </div>
  <script>
    (async () => {
      const accountNumber = "10001"; // ここを固定で10001にする

      try {
        const res = await fetch(`/api/account?number=${encodeURIComponent(accountNumber)}`);
        const data = await res.json();

        if (!res.ok) {
          document.getElementById("msg").textContent = data?.error ?? "読み込みに失敗しました";
          return;
        }

        // 表示更新
        document.getElementById("user-name").textContent = data.name ?? "---";
        document.getElementById("account-number").textContent = data.account_number ?? accountNumber;
        document.getElementById("limit").textContent = Number(data.balance ?? 0).toLocaleString("ja-JP");

        // アイコン（aiconをicon_urlとして返している想定）
        const icon = data.icon_url ?? "https://via.placeholder.com/60";
        document.getElementById("user_icon").src = icon;

      } catch (e) {
        document.getElementById("msg").textContent = "通信エラーです";
      }
    })();
  </script>

        </body> 
</html> 